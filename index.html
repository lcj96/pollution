<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8" />
		<title>北京2014年空气质量数据表</title>
		<script type="text/javascript" src="jquery-1.11.1.js"></script>
	</head>
	<style type="text/css">
		ul {list-style: none;
			margin: 0;
			padding: 0;	
		}
		
		li span{border-radius: 5px;}
		
		.aqi-chart-tooltip li{
			border: 1px solid #ccc;
			padding: 10px;
			display: inline-block;
			cursor: pointer;	
		}
		.aqi-chart-tooltip li:hover{
		    background:orange;
		}
		.aqi-chart span{
			display: inline-block;
			width:100px;
			height: 20px;}
		.aqi-bad{background: black;}
		.aqi-common{background: red;}
		.aqi-light{background: blue;}
		.aqi-good{background: green;}

	</style>

	<body>
		<ul class="aqi-chart-tooltip">
			<li id="bad">严重污染</li>
			<li id="common">中度污染</li>
			<li id="light">轻度污染</li>
			<li id="good">优良</li>
		</ul>
		<br>
		<ul id="chart-wrapper" class="aqi-chart">
		</ul>
	</body>
	<script>
		//定义数据 开始………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………	
		var aqiSourceData =[
		[344,325,384,120,2,11,158,158,225,500,200,210,48,220,110,200,345,458,55,4,11,222,10,22,23,54,288,100,150,35,254],
		[22,23,444,120,220,122,225,188,25,2,20,100,208,20,10,200,345,108,55,204,115,520,10,220,123,104,288,155,225,225,144],
		[105,157,147,157,154,208,63,131,323,304,332,86,452,375,355,353,78,96,34,53,55,37,263,178,64,52,200,67,264,56,123],
		[415,157,17,157,154,208,263,131,323,304,332,286,452,375,355,353,278,296,134,253,355,137,263,178,64,52,200,267,224,256,123],
		[115,115,147,111,154,208,116,131,133,304,132,186,452,375,355,353,278,296,234,253,255,237,263,178,64,52,200,117,64,56,23],
		[410,157,117,57,14,208,63,11,23,434,332,38,442,175,355,353,83,196,14,353,355,327,363,178,64,52,200,267,264,26,223],
		[22,2,444,120,220,122,225,88,5,2,20,100,208,20,10,20,345,108,55,204,115,520,10,220,123,104,28,155,25,225,14],
		[105,157,17,157,154,208,63,131,323,304,332,86,452,375,35,353,78,96,34,53,55,37,63,178,64,52,100,67,264,56,23],
		[415,157,17,157,154,208,23,131,323,304,332,286,45,375,355,353,278,296,34,53,55,37,263,178,64,52,200,267,24,256,123],
		[15,15,147,1,154,208,6,11,33,304,32,86,452,375,55,353,78,96,34,53,55,3,263,178,64,52,200,7,264,56,123],
		[410,157,117,157,14,208,163,111,323,434,332,38,42,175,355,353,13,196,134,253,155,327,23,178,64,52,200,26,264,226,223],
		[110,357,317,157,224,208,263,211,323,434,332,138,242,2175,355,353,213,196,134,453,455,427,23,478,464,452,400,446,464,426,423],
		]
	
		var AQIgoodMAX = 100;
		var AQIlightMAX = 200;
		var AQIcommonMAX = 300;
	function transDataFormat(src)
			{
			var outputData = {
				"aqiBad":0,
				"aqiCommon":0,
				"aqiLight":0,
				"aqiGood":0		
				};
			
			for (var i = 0, len = src.length; i < len;i++ )
				{
				if(src[i] < AQIgoodMAX){
					outputData.aqiGood++;
				}else if(src[i] < AQIlightMAX){
					outputData.aqiLight++;
				}else if(src[i] < AQIcommonMAX){
					outputData.aqiCommon++;
				}else{
					outputData.aqiBad++;
					}
				}	
				return outputData;
			}

			var a = 20;
			var b = 20;
			var c = 20;
			var d = 20;	

		function renderMonthChart(month,data)
		{	var returnHtml = [];
				returnHtml += '<li>';
				returnHtml += month + ':';
				returnHtml += '<span class="aqi-bad" style="width:'+ data.aqiBad * a +'px"></span>';
				returnHtml += '<span class="aqi-common" style="width:'+ data.aqiCommon * b+'px"></span>';
				returnHtml += '<span class="aqi-light" style="width:'+ data.aqiLight * c +'px"></span>';
				returnHtml += '<span class="aqi-good" style="width:'+ data.aqiGood  * d +'px"></span>';
				returnHtml += '</li>';
				return returnHtml;
		}
		var bad = document.getElementById("bad");
		var common = document.getElementById("common");
		var light = document.getElementById("light");
		var good = document.getElementById("good");	
		        var e = 1;
				var f = 1;
				var g = 1;
				var h = 1;
		
        bad.onclick = function(){e++;if(e%2==0){a=0}else{a=20};aqiChartGenerate();};
		common.onclick = function(){f++;if(f%2==0){b=0}else{b=20};aqiChartGenerate();};
		light.onclick = function(){g++;if(g%2==0){c=0}	else{c=20};aqiChartGenerate();};
	    good.onclick = function(){h++;if(h%2==0){d=0}else{d=20};aqiChartGenerate();};		
		
		
		function aqiChartGenerate()
		{
			var chartHtml = "";
			for(var i = 0,len = aqiSourceData.length;i < len; i++)
				{
				if(i < 9){var monthText = (i + 1) + ' 月';}
				else{var monthText = (i + 1) + '月';}
				var monthData = transDataFormat(aqiSourceData[i]) ;
				chartHtml += renderMonthChart(monthText,monthData);
				}
				document.getElementById("chart-wrapper").innerHTML = chartHtml;
			}
		aqiChartGenerate();




	</script>

</html>

